- name: Run talker & listener tests
  run: |
    source /opt/ros/jazzy/setup.bash
    cd ros2_ws
    source install/setup.bash

    # talker を起動（サービス提供側）
    ros2 run mypkg talker &
    TALKER_PID=$!

    sleep 3

    # talker / listener 関連テストだけ実行
    pytest src/mypkg/test/test_talker.py src/mypkg/test/test_listener.py

    kill $TALKER_PID

